<loader [showLoader]="isShowLoader"></loader>

<div class="saved-details custom-cbox-green" *ngIf="savedCardForm != undefined">
    <form [formGroup]="savedCardForm" (ngSubmit)="pay(savedCardForm.value, savedCardForm.valid)">
        <!-- <h3>Saved Payment Options</h3> -->
        <div class="card-detail" [class.active]="selectedCardIndex !== undefined && selectedCardIndex===i" formArrayName="cards" *ngFor="let card of savedCardForm.get('cards')['controls']; let i=index">
            <ng-container [formGroupName]="i">
                <!-- <i class="icon-circle-delete delete-ico" (click)="deleteCard(i)"></i> -->
                <label>    
                    <input id="{{'csc_'+i}}" (click)="changeSavedCard(i, csc.checked)" type="radio" name="saved_card" #csc>
                    <span class="custom-box icon-box"></span>
                    <span class="chk-txt">
                        <span class="detail-txt">
                            <!-- <span class="bank-name">{{savedCards[i]['name_on_card']}}</span> -->
                            
                            <span class="card-no"> {{savedCards[i]['card_no']}}</span>
                            <span class="input-sec is-focus"  (click)="stop($event)" *ngIf="selectedCardIndex !== undefined && selectedCardIndex===i">
                                <input type="password" maxlength="3" (keyup)="checkpayEnable(cvv.value)" placeholder="CVV" formControlName="cvv" #cvv>
                                <!-- <span class="label">CVV</span> -->
                            </span>
                        </span>
                    </span>
                    <span class="img-logo f-right">
                        <img src="{{imagePath}}img/others/visa.png" *ngIf="savedCards[i]['card_brand'] == 'VISA'">
                        <img src="{{imagePath}}img/others/mastero.png" *ngIf="savedCards[i]['card_brand'] == 'MASTERO'">
                        <img src="{{imagePath}}img/others/mastercard.png" *ngIf="savedCards[i]['card_brand'] == 'MASTERCARD'">
                   </span>
                </label>
            </ng-container>
        </div>
        <div class="text-center" *ngIf="selectedCardIndex !== undefined">
            <div class="continue-button">
                    <div class="container">
                        <p class="total-mount" *ngIf="totalPayableAmount>0"> 
                            <span class="payable-amnt">Payable Amount</span>
                            ₹ {{totalPayableAmount | mathCeil | number : '1.2-2'}} 
                        </p>
                        <button [disabled]="!payEnable" type="submit" class="btn">PAY</button>
                    </div>
                </div>
            <div *ngIf="prepaidDiscount>0" class="o-hidden text-black pad-t-15">Prepaid Discount : ₹ {{prepaidDiscount | number : '1.2-2'}}</div>
        </div>
    </form>
</div>

<payu-form *ngIf="isValid&&type=='retail'" [data]="payuData"></payu-form>
<razor-pay *ngIf="isValid&&type=='tax'" [data]="payuData" ></razor-pay>
