<div id="oosSimilarTopSection" class="oosSimilarTopSection" *ngIf="productOutOfStock">
    <h2 *ngIf="productService.oosSimilarProductsData.similarData.length > 1">Consider These Available Items</h2>
    <div class="horizontal-scroll-container consider-these-products" id="horizontal-scroll-container" (scroll)="onScrollOOOSimilar($event)">
        <ng-container *ngIf="productService.oosSimilarProductsData.similarData.length > 1">
            <product-card-horizontal-grid-view [hideAd]="true" *ngFor="let card of similarForOOSContainer; let i = index;" [cardFeaturesConfig]='oosSimilarcardFeaturesConfig' [isOosSimilarCard]="true" [moduleUsedIn]="'PRODUCT_SIMILAR_OUT_OF_STOCK_TOP'" [product]="productService.oosSimilarProductsData.similarData[i]">
            </product-card-horizontal-grid-view>
        </ng-container>
        <ng-container *ngIf="similarForOOSLoaded">
            <product-card-skeleton *ngFor="let skeleton of similarForOOSContainer" class="skeleton-pd-card-container skeleton-card-view">
            </product-card-skeleton>
        </ng-container>
    </div>
</div>

<div class="pdp-container display-block" [ngClass]="{'pdp-container-remove': productOutOfStock}" *ngIf="!productNotFound">

    <div class="prod-carsl" addClass [class.hasOneImage]="productAllImages?.length === 1" [ngClass]="[carouselInitialized ? '' : 'before-init']">
        <div class="fixed-strip">
            <span class="fixed_ico" (click)="loadProductShare()"><i class="icon-product_share"></i></span>
            <span class="fixed_ico wishlist" [class.active]="isPurcahseListProduct" (click)="addToPurchaseList()">
                <i [ngClass]="isPurcahseListProduct ? 'icon-wishlist1-active' : 'icon-wishlist1-inactive'"></i>
            </span>
            <span *ngIf="productOutOfStock  && productService.oosSimilarProductsData.similarData.length > 2" (click)="scrollToId(!productOutOfStock ? 'similarProducts' : 'similarProductsOos')" class="fixed_ico fixed_ico-img"><img src="{{imagePathAsset}}assets/img/similar-ico.svg">
            </span>
        </div>
        <ng-container #productCrousel></ng-container>
        <div class="prod-carsl-pseudo" (click)="openPopUpcrousel(0)" swipe (next)="onRotateNext()" #productCrouselPseudo (previous)="onRotatePrevious()">
            <div class="oos-tag" *ngIf="productOutOfStock">
                <span>
                    AVAILABLE ON REQUEST
                </span>
            </div>
            <div class="img-block-pseudo">
                <div class="inner-block-pseudo">
                    <div class="pinch-zoom element-pseudo" (click)="sendProductImageClickTracking()" style="transform-origin: 0% 0%;">
                        <img *ngIf="!isProductCrouselLoaded" src="{{productAllImages[0]['large'] }}" height="330" width="330" alt="{{productName}}">
                        <img *ngIf="isProductCrouselLoaded" src="{{imagePathAsset}}assets/img/loader_new.gif" class="loader-image" />
                    </div>
                </div>
                <ul class="pager">
                    <ng-container *ngIf="!isProductCrouselLoaded && !productCrouselInstance && iOptions?.pager && productAllImages?.length>1">
                        <ng-container *ngFor="let item of productAllImages;let i=index">
                            <li *ngIf="item['contentType'] == 'IMAGE'" class="pager_dot" (click)="loadProductCrousel(i)" [ngClass]="{'active': ( i==0 && !isProductCrouselLoaded ) || ( i==1 && isProductCrouselLoaded) }">
                            </li>
                            <li *ngIf="item['contentType'] == 'YOUTUBE_VIDEO'" (click)="loadProductCrousel(i)" class="pager_icon_dot">
                                <em class="icon-youtube"></em>
                            </li>
                        </ng-container>
                    </ng-container>
                </ul>
            </div>
        </div>

        <!-- TODO: check how this section is used in PQA -->
        <ng-container *ngIf="productTags != undefined && !this.productOutOfStock">
            <div class="image_tag">
                <div class="tag_container" *ngFor="let tag of productTags | arrayFilterPipe : 'type': 'image': 'object' | slice:0:1;let i = index;">
                    <img src="{{tag.imageUrl}}">
                </div>
            </div>
        </ng-container>
    </div>

    <!-- TO DO - create component - product-description  END
        SCSS - @import '@import '../../scss/product-description';
        @import '../../scss/quantity';'; -->

    <product-description (checkBulkPriceMode)="checkBulkPriceMode()" [isBulkPricesProduct]="isBulkPricesProduct" [productBulkPrices]="productBulkPrices" [selectedProductBulkPrice]="selectedProductBulkPrice" [qunatityFormControl]="qunatityFormControl" [productPrice]="productPrice"
        [productName]="productName" [productTags]="productTags" [refinedProdTags]="refinedProdTags" [productMrp]="productMrp" [priceWithoutTax]="priceWithoutTax" [productDiscount]="productDiscount" [bulkPriceWithoutTax]="bulkPriceWithoutTax" [bulkDiscount]="bulkDiscount"
        [taxPercentage]="taxPercentage" [bulkSellingPrice]="bulkSellingPrice" [productOutOfStock]="productOutOfStock" [productMinimmumQuantity]="productMinimmumQuantity" [priceQuantityCountry]="priceQuantityCountry" [starsCount]="starsCount" [rawReviewsData]="rawReviewsData"
        [rawProductCountMessage]="rawProductCountMessage">
    </product-description>
    <!-- TO DO - create component - product-description  END
        SCSS -@import '../../scss/product-description';
    @import '../../scss/quantity'; -->

    <!-- CTA Fixed position -->
    <div class="bottom-bar" [class.highIndex]="displayCardCta" *ngIf="!productOutOfStock">
        <button class="cart-btn ml-5 bold-txt f-14 f-left" (click)="showFBT()">
            <i class="icon-cart1"></i>
            <span>ADD TO CART</span>
        </button>
        <div class="buy-now f-right f-14">
            <button class="f-14" (click)="addToCart(true);">BUY NOW</button>
        </div>
    </div>
    <!-- CTA Fixed position -->

    <!-- Product bulk quantity section starts -->
    <section class="grouping_wrap_pdp" *ngIf="!isCommonProduct">
        <div *ngFor="let list of productFilterAttributesList" class="singlewrap">
            <p class="heading-3">{{list.name}}</p>
            <ul>
                <li *ngFor="let item of list.items;let i = index;" (click)="!item.selected && item.active ? updateAttr(item.msn) : removeOosSimilarSection();">
                    <a [ngClass]="{'selected': item.selected , 'inactive': !item.active}">{{item.value}}</a>
                </li>
            </ul>
        </div>
    </section>
    <!-- Product bulk quantity section ends -->

    <!-- Product quantity action section starts -->

    <!-- TO DO - create component - product-bulk-qauntity  STARTS
    SCSS - @import '../../scss/bulk-quantity'; -->
    <product-bulk-quantity (checkBulkPriceMode$)="checkBulkPriceMode()" [rawProductData]="rawProductData" [productOutOfStock]="productOutOfStock" [isCommonProduct]="isCommonProduct" [priceQuantityCountry]="priceQuantityCountry" [productBulkPrices]="productBulkPrices"
        [cartQunatityForProduct]="cartQunatityForProduct" [qunatityFormControl]="qunatityFormControl">
    </product-bulk-quantity>

    <!-- TO DO - create component - product-bulk-qauntity  END
    SCSS - @import '../../scss/bulk-quantity'; -->

    <!-- Product quantity action section ends -->
    <div *ngIf="!productOutOfStock" class="deals-block bg-white" observeVisibility [debounceTime]="300" (visible)="onVisibleOffer($event)">
        <ng-container #offerSection></ng-container>
    </div>
    <div observeVisibility [debounceTime]="100" (visible)="onVisiblePincodeSection($event)" *ngIf="!productOutOfStock">
        <ng-container #pincodeForm></ng-container>
    </div>
    <!-- other sections starts -->

    <div>
        <!-- RFQ section ends -->


        <!-- TO DO - create component - product-feature-benefits  STARTS
            SCSS - @import '../../scss/moglix-benfits'; -->
        <div class="pwa-row pwa-row-noPad moglix-benefits" *ngIf="isProductReturnAble && !productOutOfStock">
            <!-- start moglix benifits -->
            <div class="pdp-section-header">
                <h3 class="heading-3">
                    Moglix Benefits
                </h3>
            </div>
            <div class="pwa-col-12 pwa-tabs-container pad-lr-15">
                <div class="pwa-image-tab">
                    <span class="tab-img">
                        <i class="icon-Group-14030"></i>
                    </span>
                    <span class="tab-img-txt">
                        GST Invoice<br> Available
                    </span>
                </div>
                <div class="pwa-image-tab">
                    <span class="tab-img">
                        <i class="icon-secure-payment-fill"></i>
                    </span>
                    <span class="tab-img-txt">
                        Secure <br> Payments
                    </span>
                </div>
                <div class="pwa-image-tab">
                    <span class="tab-img">
                        <i class="icon-customer-service-fill"></i>
                    </span>
                    <span class="tab-img-txt">
                        365 Days <br> Help Desk
                    </span>
                </div>
            </div>
            <div class="pdp-section-header">
                <h3 class="heading-3">
                    Return Policy
                </h3>
            </div>
            <div class="pwa-col-12 pwa-tabs-container pad-lr-15">
                <div class="pwa-image-tab" (click)="$event.stopPropagation(); navigateToFAQ();">
                    <span class="tab-img">
                        <i class="icon-restart-line"></i>
                    </span>
                    <span class="tab-img-txt">
                        Upto 7 days <br /> returnable
                    </span>
                </div>
                <div class="pwa-image-tab" (click)="$event.stopPropagation();navigateToFAQ();">
                    <span class="tab-img">
                        <i class="icon-restart-line-1"></i>
                    </span>
                    <span class="tab-img-txt">
                        Wrong <br /> Product
                    </span>
                </div>
                <div class="pwa-image-tab" (click)="$event.stopPropagation();navigateToFAQ();">
                    <span class="tab-img">
                        <i class="icon-restart-line-3"></i>
                    </span>
                    <span class="tab-img-txt">
                        Damaged <br /> Product
                    </span>
                </div>
                <div class="pwa-image-tab" (click)="$event.stopPropagation();navigateToFAQ();">
                    <span class="tab-img">
                        <i class="icon-restart-line-2"></i>
                    </span>
                    <span class="tab-img-txt">
                        Defective <br />Product
                    </span>
                </div>
            </div>
        </div>
        <!-- TO DO - create component - product-bulk-benefits  END
            SCSS - @import '../../scss/moglix-benfits'; -->


        <app-product-feature-details (showYTVideo$)="showYTVideo1($event)" (handleProductInfoPopup$)="handleProductInfoPopup1($event)" [productKeyFeatures]="productKeyFeatures" [productAttributes]="productAttributes" [productDescripton]="productDescripton" [productCategoryDetails]="productCategoryDetails"
            [productBrandDetails]="productBrandDetails" [productName]="productName" [productVideos]="productVideos" [productDocumentInfo]="productDocumentInfo" [productBrandCategoryUrl]="productBrandCategoryUrl"></app-product-feature-details>


        <section *ngIf="productOutOfStock && !isRFQSuccessfull && !isAskQuestionPopupOpen" observeVisibility [debounceTime]="100" (visible)="onVisibleProductRFQ($event)">
            <ng-container #productRFQ></ng-container>
        </section>

        <section class="card" [ngClass]="{'fbtSection': fbtComponentInstance}" observeVisibility [debounceTime]="100" (visible)="getFbtIntance($event)">
            <ng-container #fbt></ng-container>
        </section>

        <app-product-review [productName]="productName" [reviewLength]="reviewLength" [overallRating]="overallRating" [rawReviewsData]="rawReviewsData" (writeReview)="writeReview($event)" (reviewRatingPopup)="handleReviewRatingPopup($event)" (postHelpful)="handlePostHelpful($event)"></app-product-review>

        <app-product-qa [questionAnswerList]="questionAnswerList" (handleFaqListPopup)="handleFaqListPopup()" (askQuestion)="askQuestion()">
        </app-product-qa>

        <!-- <div id="get-quote-section" class="buy-nowsec" *ngIf="commonService.isBrowser && commonService.userSession && commonService.userSession.authenticated === 'true' && this.commonService.userSession.phone && !productOutOfStock && productMrp > 0">
            <h4 class="heading-3">Looking for {{ productCategoryDetails["categoryName"] }}</h4>
            <p class="small-txt prodct-name"> {{ productName }} </p>
            <div class="buynow-flex">
                <div class="bn-left">
                    <p class="heading-4"><i class="icon-check-active"></i>&nbsp; Purchase item in bulk quantity</p>
                    <p class="heading-4"><i class="icon-check-active"></i>&nbsp;Get at best price for your business</p>
                </div>
                <div class="bn-right">
                    <img [attr.src]="productAllImages[0]['small']" width="50" height="50">
                </div>
            </div>
            <div class="button-sec shimmer">
                <ng-container *ngIf="rfqQuoteRaised; then raisedTemplate else nonRaisedTemplate"></ng-container>
                <ng-template #nonRaisedTemplate>
                    <p class="small-txt">We will get in touch with you on<br>
                        <ng-container *ngIf="commonService?.userSession?.authenticated === 'true'">
                            {{ '+91-' + commonService?.userSession?.phone }}
                            <ng-container *ngIf="commonService?.userSession?.email">
                                {{ ' | ' +commonService?.userSession?.email }}
                            </ng-container>
                        </ng-container>
                    </p>
                    <div class="swiper">
                        <div id="button-background" class="button-area wrapper">
                            <button class="slide-text shimmer-button">SLIDE TO RAISE REQUEST </button>
                            <div id="animate-slider" class="arrow-container next-btn next-btn-invalid" (mousedown)="sliderMouseDownEvent($event)" (touchstart)="sliderMouseDownEvent($event)">
                                <i class="icon-next icon-animate-1"></i>
                                <i class="icon-next icon-animate-2"></i>
                                <i class="icon-next icon-animate-3"></i>
                            </div>
                        </div>
                    </div>
                </ng-template>
                <ng-template #raisedTemplate>
                    <p class="small-txt">Thank you! Our support member will get in touch with you within 24 hours.</p>
                    <div class="button-area wrapper">
                        <button class="valid-button shimmer-button">REQUESTED SUCCESSFULLY</button>
                    </div>
                </ng-template>
            </div>
        </div>


        <div class="pwa-row inline-list-item-variant1" *ngIf="commonService.isBrowser && commonService.userSession && !this.commonService.userSession.phone && !productOutOfStock && productMrp > 0">
            <div class="inline-list-icon">
                <i class="icon-dropbox-fill"></i>
            </div>
            <div class="inline-list-text">
                <strong>Interested to buy in bulk</strong>
                <small>Get customized price</small>
            </div>
            <div class="inline-list-link">
                <span class="get-quote" (click)="raiseRFQQuote();">Get Quote</span>
            </div>
        </div> -->

        <app-product-get-quote (sliderMouseDownEvent$)="sliderMouseDownEvent($event)" (raiseRFQQuote$)="raiseRFQQuote()" [rfqQuoteRaised]="rfqQuoteRaised" [productOutOfStock]="productOutOfStock" [productMrp]="productMrp" [productCategoryDetails]="productCategoryDetails"
            [productName]="productName" [productAllImages]="productAllImages"></app-product-get-quote>

        <section id="similarProducts" observeVisibility [debounceTime]="100" (visible)="onVisibleSimilar($event)">
            <ng-container #similarProduct></ng-container>
        </section>

        <app-product-more-widget [taxons]="taxons" [baseDomain]="baseDomain" [orderTracking]="orderTracking" [productBrandDetails]="productBrandDetails" [productCategoryDetails]="productCategoryDetails" [productBrandCategoryUrl]="productBrandCategoryUrl">
        </app-product-more-widget>

        <section id="sponseredProducts" observeVisibility [debounceTime]="100" (visible)="onVisibleSponsered($event)">
            <ng-container #sponseredProducts></ng-container>
        </section>


        <section id="productAccordianSection" observeVisibility [debounceTime]="100" (visible)="onVisibleProductAccordians($event)">
            <ng-container #pdpAccordian></ng-container>
        </section>

        <ng-container *ngIf="breadcrumbData && breadcrumbData.length > 0 && productOutOfStock">
            <breadcrumb-nav [breadcrumb]="breadcrumbData" [analytics]="breadCrumbAnalytics"></breadcrumb-nav>
        </ng-container>

        <section *ngIf="productOutOfStock" id="similarProductsOos" observeVisibility [debounceTime]="100" (visible)="onVisibleSimilarOOS($event)">
            <ng-container #similarProductOOS></ng-container>
        </section>

        <past-orders *ngIf="isBrowser && isLoggedIn" [outOfStock]="productOutOfStock" [analytics]="pastOrderAnalytics">
        </past-orders>

        <div class="pwa-row app-promo" observeVisibility [debounceTime]="300" (visible)="onVisibleAppPromo($event)">
            <div class="pwa-col-12">
                <ng-container #appPromo></ng-container>
            </div>
        </div>

        <section observeVisibility class="pwa-col-12" [debounceTime]="100" [ngClass]="{'recent_section': !recentProductsInstance}" (visible)="onVisibleRecentProduct($event)">
            <ng-container #recentProducts></ng-container>
            <div class="loader_container" *ngIf="!recentProductsInstance">
                <div class="loader"></div>
            </div>
        </section>

        <div [class.mb-60]="productOutOfStock && productService.oosSimilarProductsData.similarData.length < 3"></div>
        <ng-container *ngIf="breadcrumbData && breadcrumbData.length > 0 && !productOutOfStock">
            <breadcrumb-nav [breadcrumb]="breadcrumbData" [analytics]="breadCrumbAnalytics"></breadcrumb-nav>
        </ng-container>
    </div>
</div>

<div *ngIf="productOutOfStock && !showScrollToTopButton && productService.oosSimilarProductsData.similarData.length > 2" class="pdp-container">
    <div class="bottom-bar stickyBottomBtn">
        <button (click)="scrollToId(!productOutOfStock ? 'similarProducts' : 'similarProductsOos')" class="cart-btn ml-5 bold-txt f-14 f-left">
            <span>VIEW IN-STOCK</span>
        </button>
        <div class="buy-now f-right f-14">
            <button (click)="getBestPrice($event)" class="f-14">GET BEST PRICE</button>
        </div>
    </div>
</div>

<div *ngIf="productOutOfStock && !showScrollToTopButton  && (!productService.oosSimilarProductsData.similarData  || productService.oosSimilarProductsData.similarData.length <= 2 )" class="stickyBottomBtn">
    <button (click)="getBestPrice($event)" class="btn-red submit-btn">GET BEST PRICE</button>
</div>

<app-page-not-delivered *ngIf="productNotFound"></app-page-not-delivered>

// TODO: product-rfq-thanks-popup should be lazy loaded
<product-rfq-thanks-popup (closeRFQAlert$)="closeRFQAlert()" (scrollToId$)="scrollToId($event)" (navigateToCategory$)="navigateToCategory()" [rfqTotalValue]="rfqTotalValue" [hasGstin]="hasGstin" [getWhatsText]="getWhatsText" [similarProducts]="similarProducts"
    [productOutOfStock]="productOutOfStock" [isRFQSuccessfull]="isRFQSuccessfull" [imagePathAsset]="imagePathAsset">
</product-rfq-thanks-popup>

// TODO: whatsapp-toast should be lazy loaded
<whatsapp-toast (click)="sendTrackingData()" [customText]="getWhatsText"></whatsapp-toast>

<ng-container *ngIf="showScrollToTopButton">
    <div class="scroll-arrow-pdp" (click)="scrollToTop()">
        <i class="icon-up"></i>
    </div>
</ng-container>


<ng-container *ngIf="!productOutOfStock" #productRFQ></ng-container>
<ng-container #rfqForm></ng-container>
<ng-container #offerPopup></ng-container>
<ng-container #offerComparePopup></ng-container>
<ng-container #writeReviewPopup></ng-container>
<ng-container #alertBox></ng-container>
<ng-container #globalToast></ng-container>
<ng-container #emiPlansPopup></ng-container>
<ng-container #reviewRatingPopup></ng-container>
<ng-container #questionAnswersPopup></ng-container>
<ng-container #productInfoPopup></ng-container>
<ng-container #faqListPopup></ng-container>
<ng-container #askQuestionPopup></ng-container>
<ng-container #faqSuccessPopup></ng-container>
<ng-container #productShare></ng-container>
<ng-container #addToCartToast></ng-container>
<ng-container #popupCrousel></ng-container>